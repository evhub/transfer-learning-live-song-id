# transfer-learning-live-song-id

Use [transfer_learning_music](https://github.com/evhub/transfer_learning_music) to implement [live song identification](https://github.com/evhub/live-song-id). Depends on [song-annotation-db](https://github.com/evhub/song-annotation-db).

## Results

For `taylorswift` with 2 reference songs and 2 query songs split into 130 6-second chunks, the model achieves an MRR of 0.9, as can be seen below.
```
Using TensorFlow backend.
Testing models...
        Processing audio array of length 81920 (80 samples)...
(160, 72)
[[1 1 1 ... 1 1 1]
 [1 1 1 ... 1 1 1]
 [1 1 1 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 0]
 [1 0 1 ... 1 1 1]
 [1 0 0 ... 1 1 1]]
Querying database...
Using existing database...
        Loading ref 0.npy...
        Loading ref 1.npy...
        Loading query 0.npy...
        Loading query 1.npy...
        Loading query 2.npy...
        Loading query 3.npy...
        Loading query 4.npy...
        Loading query 5.npy...
        Loading query 6.npy...
        Loading query 7.npy...
        Loading query 8.npy...
        Loading query 9.npy...
        Loading query 10.npy...
        Loading query 11.npy...
        Loading query 12.npy...
        Loading query 13.npy...
        Loading query 14.npy...
        Loading query 15.npy...
        Loading query 16.npy...
        Loading query 17.npy...
        Loading query 18.npy...
        Loading query 19.npy...
        Loading query 20.npy...
        Loading query 21.npy...
        Loading query 22.npy...
        Loading query 23.npy...
        Loading query 24.npy...
        Loading query 25.npy...
        Loading query 26.npy...
        Loading query 27.npy...
        Loading query 28.npy...
        Loading query 29.npy...
        Loading query 30.npy...
        Loading query 31.npy...
        Loading query 32.npy...
        Loading query 33.npy...
        Loading query 34.npy...
        Loading query 35.npy...
        Loading query 36.npy...
        Loading query 37.npy...
        Loading query 38.npy...
        Loading query 39.npy...
        Loading query 40.npy...
        Loading query 41.npy...
        Loading query 42.npy...
        Loading query 43.npy...
        Loading query 44.npy...
        Loading query 45.npy...
        Loading query 46.npy...
        Loading query 47.npy...
        Loading query 48.npy...
        Loading query 49.npy...
        Loading query 50.npy...
        Loading query 51.npy...
        Loading query 52.npy...
        Loading query 53.npy...
        Loading query 54.npy...
        Loading query 55.npy...
        Loading query 56.npy...
        Loading query 57.npy...
        Loading query 58.npy...
        Loading query 59.npy...
        Loading query 60.npy...
        Loading query 61.npy...
        Loading query 62.npy...
        Loading query 63.npy...
        Loading query 64.npy...
        Loading query 65.npy...
        Loading query 66.npy...
        Loading query 67.npy...
        Loading query 68.npy...
        Loading query 69.npy...
        Loading query 70.npy...
        Loading query 71.npy...
        Loading query 72.npy...
        Loading query 73.npy...
        Loading query 74.npy...
        Loading query 75.npy...
        Loading query 76.npy...
        Loading query 77.npy...
        Loading query 78.npy...
        Loading query 79.npy...
        Loading query 80.npy...
        Loading query 81.npy...
        Loading query 82.npy...
        Loading query 83.npy...
        Loading query 84.npy...
        Loading query 85.npy...
        Loading query 86.npy...
        Loading query 87.npy...
        Loading query 88.npy...
        Loading query 89.npy...
        Loading query 90.npy...
        Loading query 91.npy...
        Loading query 92.npy...
        Loading query 93.npy...
        Loading query 94.npy...
        Loading query 95.npy...
        Loading query 96.npy...
        Loading query 97.npy...
        Loading query 98.npy...
        Loading query 99.npy...
        Loading query 100.npy...
        Loading query 101.npy...
        Loading query 102.npy...
        Loading query 103.npy...
        Loading query 104.npy...
        Loading query 105.npy...
        Loading query 106.npy...
        Loading query 107.npy...
        Loading query 108.npy...
        Loading query 109.npy...
        Loading query 110.npy...
        Loading query 111.npy...
        Loading query 112.npy...
        Loading query 113.npy...
        Loading query 114.npy...
        Loading query 115.npy...
        Loading query 116.npy...
        Loading query 117.npy...
        Loading query 118.npy...
        Loading query 119.npy...
        Loading query 120.npy...
        Loading query 121.npy...
        Loading query 122.npy...
        Loading query 123.npy...
        Loading query 124.npy...
        Loading query 125.npy...
        Loading query 126.npy...
        Loading query 127.npy...
        Loading query 128.npy...
        Loading query 129.npy...
Calculating MRR for 2 refs and 130 queries...
==> Searching query 0
        -- Time elapsed: 0 seconds
==> Searching query 1
        -- Time elapsed: 0 seconds
==> Searching query 2
        -- Time elapsed: 0 seconds
==> Searching query 3
        -- Time elapsed: 0 seconds
==> Searching query 4
        -- Time elapsed: 0 seconds
==> Searching query 5
        -- Time elapsed: 0 seconds
==> Searching query 6
        -- Time elapsed: 0 seconds
==> Searching query 7
        -- Time elapsed: 0 seconds
==> Searching query 8
        -- Time elapsed: 0 seconds
==> Searching query 9
        -- Time elapsed: 0 seconds
==> Searching query 10
        -- Time elapsed: 0 seconds
==> Searching query 11
        -- Time elapsed: 0 seconds
==> Searching query 12
        -- Time elapsed: 0 seconds
==> Searching query 13
        -- Time elapsed: 0 seconds
==> Searching query 14
        -- Time elapsed: 0 seconds
==> Searching query 15
        -- Time elapsed: 0 seconds
==> Searching query 16
        -- Time elapsed: 0 seconds
==> Searching query 17
        -- Time elapsed: 0 seconds
==> Searching query 18
        -- Time elapsed: 0 seconds
==> Searching query 19
        -- Time elapsed: 0 seconds
==> Searching query 20
        -- Time elapsed: 0 seconds
==> Searching query 21
        -- Time elapsed: 0 seconds
==> Searching query 22
        -- Time elapsed: 0 seconds
==> Searching query 23
        -- Time elapsed: 0 seconds
==> Searching query 24
        -- Time elapsed: 0 seconds
==> Searching query 25
        -- Time elapsed: 0 seconds
==> Searching query 26
        -- Time elapsed: 0 seconds
==> Searching query 27
        -- Time elapsed: 0 seconds
==> Searching query 28
        -- Time elapsed: 0 seconds
==> Searching query 29
        -- Time elapsed: 0 seconds
==> Searching query 30
        -- Time elapsed: 0 seconds
==> Searching query 31
        -- Time elapsed: 0 seconds
==> Searching query 32
        -- Time elapsed: 0 seconds
==> Searching query 33
        -- Time elapsed: 0 seconds
==> Searching query 34
        -- Time elapsed: 0 seconds
==> Searching query 35
        -- Time elapsed: 0 seconds
==> Searching query 36
        -- Time elapsed: 0 seconds
==> Searching query 37
        -- Time elapsed: 0 seconds
==> Searching query 38
        -- Time elapsed: 0 seconds
==> Searching query 39
        -- Time elapsed: 0 seconds
==> Searching query 40
        -- Time elapsed: 0 seconds
==> Searching query 41
        -- Time elapsed: 0 seconds
==> Searching query 42
        -- Time elapsed: 0 seconds
==> Searching query 43
        -- Time elapsed: 0 seconds
==> Searching query 44
        -- Time elapsed: 0 seconds
==> Searching query 45
        -- Time elapsed: 0 seconds
==> Searching query 46
        -- Time elapsed: 0 seconds
==> Searching query 47
        -- Time elapsed: 0 seconds
==> Searching query 48
        -- Time elapsed: 0 seconds
==> Searching query 49
        -- Time elapsed: 0 seconds
==> Searching query 50
        -- Time elapsed: 0 seconds
==> Searching query 51
        -- Time elapsed: 0 seconds
==> Searching query 52
        -- Time elapsed: 0 seconds
==> Searching query 53
        -- Time elapsed: 0 seconds
==> Searching query 54
        -- Time elapsed: 0 seconds
==> Searching query 55
        -- Time elapsed: 0 seconds
==> Searching query 56
        -- Time elapsed: 0 seconds
==> Searching query 57
        -- Time elapsed: 0 seconds
==> Searching query 58
        -- Time elapsed: 0 seconds
==> Searching query 59
        -- Time elapsed: 0 seconds
==> Searching query 60
        -- Time elapsed: 0 seconds
==> Searching query 61
        -- Time elapsed: 0 seconds
==> Searching query 62
        -- Time elapsed: 0 seconds
==> Searching query 63
        -- Time elapsed: 0 seconds
==> Searching query 64
        -- Time elapsed: 0 seconds
==> Searching query 65
        -- Time elapsed: 0 seconds
==> Searching query 66
        -- Time elapsed: 0 seconds
==> Searching query 67
        -- Time elapsed: 0 seconds
==> Searching query 68
        -- Time elapsed: 0 seconds
==> Searching query 69
        -- Time elapsed: 0 seconds
==> Searching query 70
        -- Time elapsed: 0 seconds
==> Searching query 71
        -- Time elapsed: 0 seconds
==> Searching query 72
        -- Time elapsed: 0 seconds
==> Searching query 73
        -- Time elapsed: 0 seconds
==> Searching query 74
        -- Time elapsed: 0 seconds
==> Searching query 75
        -- Time elapsed: 0 seconds
==> Searching query 76
        -- Time elapsed: 0 seconds
==> Searching query 77
        -- Time elapsed: 0 seconds
==> Searching query 78
        -- Time elapsed: 0 seconds
==> Searching query 79
        -- Time elapsed: 0 seconds
==> Searching query 80
        -- Time elapsed: 0 seconds
==> Searching query 81
        -- Time elapsed: 0 seconds
==> Searching query 82
        -- Time elapsed: 0 seconds
==> Searching query 83
        -- Time elapsed: 0 seconds
==> Searching query 84
        -- Time elapsed: 0 seconds
==> Searching query 85
        -- Time elapsed: 0 seconds
==> Searching query 86
        -- Time elapsed: 0 seconds
==> Searching query 87
        -- Time elapsed: 0 seconds
==> Searching query 88
        -- Time elapsed: 0 seconds
==> Searching query 89
        -- Time elapsed: 0 seconds
==> Searching query 90
        -- Time elapsed: 0 seconds
==> Searching query 91
        -- Time elapsed: 0 seconds
==> Searching query 92
        -- Time elapsed: 0 seconds
==> Searching query 93
        -- Time elapsed: 0 seconds
==> Searching query 94
        -- Time elapsed: 0 seconds
==> Searching query 95
        -- Time elapsed: 0 seconds
==> Searching query 96
        -- Time elapsed: 0 seconds
==> Searching query 97
        -- Time elapsed: 0 seconds
==> Searching query 98
        -- Time elapsed: 0 seconds
==> Searching query 99
        -- Time elapsed: 0 seconds
==> Searching query 100
        -- Time elapsed: 0 seconds
==> Searching query 101
        -- Time elapsed: 0 seconds
==> Searching query 102
        -- Time elapsed: 0 seconds
==> Searching query 103
        -- Time elapsed: 0 seconds
==> Searching query 104
        -- Time elapsed: 0 seconds
==> Searching query 105
        -- Time elapsed: 0 seconds
==> Searching query 106
        -- Time elapsed: 0 seconds
==> Searching query 107
        -- Time elapsed: 0 seconds
==> Searching query 108
        -- Time elapsed: 0 seconds
==> Searching query 109
        -- Time elapsed: 0 seconds
==> Searching query 110
        -- Time elapsed: 0 seconds
==> Searching query 111
        -- Time elapsed: 0 seconds
==> Searching query 112
        -- Time elapsed: 0 seconds
==> Searching query 113
        -- Time elapsed: 0 seconds
==> Searching query 114
        -- Time elapsed: 0 seconds
==> Searching query 115
        -- Time elapsed: 0 seconds
==> Searching query 116
        -- Time elapsed: 0 seconds
==> Searching query 117
        -- Time elapsed: 0 seconds
==> Searching query 118
        -- Time elapsed: 0 seconds
==> Searching query 119
        -- Time elapsed: 0 seconds
==> Searching query 120
        -- Time elapsed: 0 seconds
==> Searching query 121
        -- Time elapsed: 0 seconds
==> Searching query 122
        -- Time elapsed: 0 seconds
==> Searching query 123
        -- Time elapsed: 0 seconds
==> Searching query 124
        -- Time elapsed: 0 seconds
==> Searching query 125
        -- Time elapsed: 0 seconds
==> Searching query 126
        -- Time elapsed: 0 seconds
==> Searching query 127
        -- Time elapsed: 0 seconds
==> Searching query 128
        -- Time elapsed: 0 seconds
==> Searching query 129
        -- Time elapsed: 0 seconds
MMR = 0.9
```
